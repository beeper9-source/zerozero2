<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zero Zero 2 Admin</title>
  <link rel="stylesheet" href="./styles2.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <!-- Supabase JS CDN -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Your Supabase config initializer -->
  <script defer src="./supabase-config.js"></script>
  <!-- App logic -->
  <script defer src="./app.js"></script>
</head>
<body>
  <!-- 로그인 섹션 -->
  <div id="loginSection" class="login-container">
    <div class="login-card">
      <div class="login-header">
        <img src="./Samsung_Logo.svg" alt="Samsung" style="width:48px;height:48px;margin-bottom:20px;">
        <h2>Zero Zero 2 Admin</h2>
        <p>Samsung 직원만 접근 가능합니다</p>
      </div>
      
      <form id="loginForm" class="login-form">
        <div class="form-group">
          <label for="email">이메일 (Samsung 계정)</label>
          <input type="email" id="email" name="email" placeholder="your.name@samsung.com" required>
          <div id="emailError" class="error-message"></div>
        </div>
        
        <div class="form-group">
          <label for="password">비밀번호</label>
          <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required>
          <div id="passwordError" class="error-message"></div>
        </div>
        
        <button type="submit" id="loginBtn" class="login-btn">
          <i class="fas fa-sign-in-alt"></i> 로그인
        </button>
        
        <div id="loginError" class="error-message"></div>
      </form>
      
      <div class="login-footer">
        <p><i class="fas fa-info-circle"></i> Samsung.com 도메인만 사용 가능합니다</p>
      </div>
    </div>
  </div>

  <!-- 메인 애플리케이션 (로그인 후 표시) -->
  <div id="mainApp" class="main-app" style="display: none;">
  <div class="container">
    <header class="header">
      <h1><img src="./Samsung_Logo.svg" alt="Samsung" style="width:32px;height:32px;margin-right:8px;vertical-align:middle;"> Zero Zero 2</h1>
      <div class="header-actions">
        <button class="btn btn-primary" id="pcourtLoad"><i class="fas fa-building"></i> 코트 불러오기</button>
        <button class="btn btn-info" id="pmemLoad"><i class="fas fa-users"></i> 회원 불러오기</button>
        <button class="btn btn-secondary" id="pgameLoad"><i class="fas fa-list"></i> 결과 불러오기</button>
      </div>
    </header>

    <div class="search-section" style="margin-bottom:16px;">
      <div class="row" style="justify-content:space-between;">
        <div><strong>Status:</strong> <span id="status">Ready</span></div>
        <div><span id="errors" class="error"></span></div>
      </div>
    </div>

  <div class="search-section">
  <h2 style="margin-bottom:10px; cursor: pointer; user-select: none;" onclick="toggleSection('gameResult')">
    <i class="fas fa-trophy"></i> P_game_result (게임결과)
    <i class="fas fa-chevron-down" id="gameResult-chevron" style="float: right; transition: transform 0.3s ease;"></i>
  </h2>
  <div id="gameResult-content" class="section-content">
  <div class="row">
    <button id="pgameLoad">Load results</button>
  </div>
  <div class="row">
    <label for="pgameDate"><i class="fas fa-key" style="color:#e53e3e; margin-right:5px;"></i>date</label>
    <input id="pgameDate" type="date" />
  </div>
  <div class="row">
    <label for="pgameMember"><i class="fas fa-key" style="color:#e53e3e; margin-right:5px;"></i>member</label>
    <select id="pgameMember"></select>
  </div>
  <div class="row">
    <label for="pgameWins">wins</label>
    <input id="pgameWins" type="number" min="0" value="0" />
  </div>
  <div class="row">
    <label for="pgameLosses">losses</label>
    <input id="pgameLosses" type="number" min="0" value="0" />
  </div>
  <div class="row">
    <label for="pgameCourt">court</label>
    <select id="pgameCourt"></select>
  </div>
  <div class="row">
    <button id="pgameCreate">Save</button>
    <button id="pgameUpdate">Update</button>
    <button id="pgameDelete">Delete</button>
  </div>
  <!-- Game Results Table -->
  <div style="overflow:auto; margin-top:20px; display:flex; justify-content:center;">
    <table id="pgameTable" style="border-collapse:collapse; background:#fff; margin:0 auto;">
      <thead>
        <tr style="background:#f7fafc;">
          <th style="text-align:center; padding:8px; border-bottom:1px solid #e2e8f0;">Date</th>
          <th style="text-align:center; padding:8px; border-bottom:1px solid #e2e8f0;">Winrate</th>
          <th style="text-align:center; padding:8px; border-bottom:1px solid #e2e8f0;">Member</th>
          <th style="text-align:center; padding:8px; border-bottom:1px solid #e2e8f0;">Court</th>
        </tr>
      </thead>
      <tbody id="pgameTableBody"></tbody>
    </table>
  </div>
  </div>
  </div>

  <div class="search-section">
  <h2 style="margin-bottom:10px; cursor: pointer; user-select: none;" onclick="toggleSection('member')">
    <i class="fas fa-user"></i> P_member (회원)
    <i class="fas fa-chevron-down" id="member-chevron" style="float: right; transition: transform 0.3s ease;"></i>
  </h2>
  <div id="member-content" class="section-content">
  <div class="row">
    <button id="pmemLoad">Load members</button>
    <button id="pmemCreate">Add Member</button>
    <button id="pmemShowDUPRLogic" style="background-color: #10b981; color: white;">DUPR 점수 산정 로직</button>
  </div>
  
  <!-- Member Sort Options -->
  <div class="row" style="margin-top: 10px;">
    <label for="pmemSort" style="margin-right: 10px; font-weight: bold;">정렬 기준:</label>
    <select id="pmemSort" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
      <option value="name">이름순</option>
      <option value="dupr">DUPR 점수</option>
      <option value="games">참여일수</option>
      <option value="winrate">승률</option>
      <option value="wins">승수</option>
      <option value="absent" selected>이번달 불참</option>
    </select>
  </div>
  
  <!-- Attendance Status Message -->
  <div id="attendanceStatus" style="display: none; margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 10px; border-left: 4px solid #f59e0b; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
    <div style="display: flex; align-items: center; gap: 10px;">
      <i class="fas fa-info-circle" style="color: #f59e0b; font-size: 18px;"></i>
      <div>
        <p style="margin: 0; font-weight: 600; color: #92400e; font-size: 16px;" id="attendanceMessage"></p>
      </div>
    </div>
  </div>
  
  <!-- Member Form (hidden by default) -->
  <div id="pmemForm" style="display:none; margin-top:20px; padding:20px; background:#f7fafc; border-radius:8px;">
    <h3>회원 정보</h3>
    <div class="row">
      <label for="pmemName">name</label>
      <input id="pmemName" type="text" placeholder="홍길동" />
    </div>
    <div class="row">
      <label for="pmemDept">department</label>
      <input id="pmemDept" type="text" placeholder="영업팀" />
    </div>
    <div class="row">
      <button id="pmemSave">Save</button>
      <button id="pmemCancel">Cancel</button>
    </div>
  </div>
  
  <!-- Member List Table -->
  <div style="margin-top:20px;">
    <table id="pmemTable" style="width:100%; margin:0 auto;">
      <thead>
        <tr>
          <th style="text-align:center; width:60px;">No</th>
          <th style="text-align:center;">이름(부서)</th>
          <th style="text-align:center;">DUPR</th>
          <th style="text-align:center;">최종참석일</th>
        </tr>
      </thead>
      <tbody id="pmemTableBody">
        <!-- Member rows will be inserted here -->
      </tbody>
    </table>
  </div>
  </div>
  </div>

  <div class="search-section">
  <h2 style="margin-bottom:10px; cursor: pointer; user-select: none;" onclick="toggleSection('court')">
    <i class="fas fa-building"></i> P_court (구장)
    <i class="fas fa-chevron-down" id="court-chevron" style="float: right; transition: transform 0.3s ease;"></i>
  </h2>
  <div id="court-content" class="section-content">
  <div class="row">
    <button id="pcourtLoad">Load courts</button>
    <button id="pcourtLoadAll">Load all courts</button>
    <button id="pcourtCreate">Add Court</button>
  </div>
  
  <!-- Court Form (hidden by default) -->
  <div id="pcourtForm" style="display:none; margin-top:20px; padding:20px; background:#f7fafc; border-radius:8px;">
    <h3>구장 정보</h3>
    <div class="row">
      <label for="pcourtName">name</label>
      <input id="pcourtName" type="text" placeholder="중앙체육관 A코트" />
    </div>
    <div class="row">
      <label for="pcourtActive">활성 상태</label>
      <input id="pcourtActive" type="checkbox" checked />
    </div>
    <div class="row">
      <button id="pcourtSave">Save</button>
      <button id="pcourtCancel">Cancel</button>
    </div>
  </div>
  
  <!-- Court Cards Grid -->
  <div id="pcourtGrid" class="members-grid" style="margin-top:20px;">
    <!-- Court cards will be inserted here -->
  </div>
  </div>
  </div>

  <!-- 통계분석 섹션 -->
  <div class="search-section">
  <h2 style="margin-bottom:10px; cursor: pointer; user-select: none;" onclick="toggleSection('statistics')">
    <i class="fas fa-chart-bar"></i> 통계분석 (Statistics)
    <i class="fas fa-chevron-down" id="statistics-chevron" style="float: right; transition: transform 0.3s ease;"></i>
  </h2>
  <div id="statistics-content" class="section-content">
  <div class="row">
    <button id="statisticsLoad">통계 로드</button>
    <button id="statisticsRefresh">새로고침</button>
  </div>
  
  <!-- 통계 데이터 표시 영역 -->
  <div id="statisticsContainer" style="margin-top:20px;">
    <!-- 월별 참석자 추이 -->
    <div class="statistics-card" style="margin-bottom:20px; padding:20px; background:#f8fafc; border-radius:8px; border-left:4px solid #3b82f6;">
      <h3 style="margin:0 0 15px 0; color:#1e40af;"><i class="fas fa-calendar-alt"></i> 월별 참석자 추이</h3>
      <div id="monthlyAttendanceChart" style="min-height:200px;">
        <!-- 차트 데이터가 여기에 표시됩니다 -->
      </div>
    </div>
    
    <!-- 구장별 참여일수 -->
    <div class="statistics-card" style="margin-bottom:20px; padding:20px; background:#f8fafc; border-radius:8px; border-left:4px solid #10b981;">
      <h3 style="margin:0 0 15px 0; color:#059669;"><i class="fas fa-building"></i> 구장별 참여일수</h3>
      <div id="courtParticipationChart" style="min-height:200px;">
        <!-- 차트 데이터가 여기에 표시됩니다 -->
      </div>
    </div>
    
    <!-- 회원별 활동 통계 -->
    <div class="statistics-card" style="margin-bottom:20px; padding:20px; background:#f8fafc; border-radius:8px; border-left:4px solid #f59e0b;">
      <h3 style="margin:0 0 15px 0; color:#d97706;"><i class="fas fa-users"></i> 회원별 활동 통계</h3>
      <div id="memberActivityStats" style="min-height:200px;">
        <!-- 통계 데이터가 여기에 표시됩니다 -->
      </div>
    </div>
    
    <!-- 전체 요약 통계 -->
    <div class="statistics-card" style="margin-bottom:20px; padding:20px; background:#f8fafc; border-radius:8px; border-left:4px solid #8b5cf6;">
      <h3 style="margin:0 0 15px 0; color:#7c3aed;"><i class="fas fa-chart-pie"></i> 전체 요약 통계</h3>
      <div id="overallStats" style="min-height:200px;">
        <!-- 요약 통계가 여기에 표시됩니다 -->
      </div>
    </div>
  </div>
  </div>
  </div>

  <!-- Footer with source update date -->
  <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #64748b; font-size: 0.9rem; border-top: 1px solid #e2e8f0;">
    <p>소스 최종 반영일: <span id="lastUpdateDate"></span></p>
    <p style="margin-top: 8px;">소스위치: <a href="https://github.com/beeper9-source/zerozero2" target="_blank" style="color: #667eea; text-decoration: none;">github.com/beeper9-source/zerozero2</a></p>
    <div style="margin-top: 15px;">
      <button id="logoutBtn" class="btn btn-secondary">
        <i class="fas fa-sign-out-alt"></i> 로그아웃
      </button>
    </div>
  </footer>

  <noscript>자바스크립트가 필요합니다.</noscript>
  </div>
  </div> <!-- 메인 앱 닫기 -->
</body>
</html>

